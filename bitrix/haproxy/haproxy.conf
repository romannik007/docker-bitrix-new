global
    #user    haproxy
    #group   haproxy
    #pidfile /var/run/haproxy.pid
    #stats   socket /var/run/haproxy.stats
    maxconn 20480
    stats socket /var/run/api.sock user haproxy group haproxy mode 660 level admin expose-fd listeners
    log stdout format raw local0 info

defaults
    #retries 3
    option  redispatch
    timeout queue 1m
    timeout client 1m
    timeout connect 10s
    timeout server 1m
    timeout check 5s

frontend stats
    mode http
    bind *:8404
    stats enable
    stats uri /
    stats refresh 10s
    log global

listen mysql-cluster
    bind *:3306
    mode tcp
    option tcpka
    option mysql-check user haproxy
    balance source
    server mysql-1 mysql:3306 check weight 1
